<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Design Notes :: MrDox</title>
    <link rel="canonical" href="https://cppalliance.github.io/mrdox/mrdox/develop/design-notes.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://cppalliance.github.io/mrdox">MrDox</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mrdox" data-version="develop">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">MrDox</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Home</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="install.html">Install</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="usage.html">Usage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="config-file.html">The Configuration File</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="commands.html">Commands</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="design-notes.html">Design Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="contribute.html">Contribute</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="license.html">License</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">MrDox</span>
    <span class="version">develop</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="index.html">MrDox</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">develop</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">MrDox</a></li>
    <li><a href="design-notes.html">Design Notes</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/cppalliance/mrdox/edit/develop/docs/modules/ROOT/pages/design-notes.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Design Notes</h1>
<div class="sect1">
<h2 id="_ast_traversal"><a class="anchor" href="#_ast_traversal"></a>AST Traversal</h2>
<div class="sectionbody">
<div class="paragraph">
<p>During the AST traversal stage, the complete AST (generated by the clang frontend)
is walked beginning with the root <code>TranslationUnitDecl</code> node. It is during this
stage that USRs (universal symbol references) are generated and hashed with SHA1
to form the 160 bit <code>SymbolID</code> for an entity. With the exception of built-in types,
<strong>all</strong> entities referenced in the corpus will be traversed and be assigned a <code>SymbolID</code>;
including those from the standard library. This is necessary to generate the
full interface for user-defined types.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bitcode"><a class="anchor" href="#_bitcode"></a>Bitcode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>AST traversal is performed in parallel on a per-translation-unit basis.
To maximize the size of the code base MrDox is capable of processing, <code>Info</code>
types generated during traversal are serialized to a compressed bitcode representation.
Once AST traversal is complete for all translation units, the bitcode is deserialized
back into <code>Info</code> types, and then merged to form the corpus. The merging step is necessar
 as there may be multiple identical definitions of the same entity (e.g. for class types,
 templates, inline functions, etc), as well as functions declared in one translation
 unit &amp; defined in another.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_corpus"><a class="anchor" href="#_the_corpus"></a>The Corpus</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After AST traversal and <code>Info</code> merging, the result is stored as a map of <code>Info`s
indexed by their respective `SymbolID`s. Documentation generators may traverse
this structure by calling `Corpus::traverse</code> with a <code>Corpus::Visitor</code> derived
visitor and the <code>SymbolID</code> of the entity to visit (e.g. the global namespace).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_namespaces"><a class="anchor" href="#_namespaces"></a>Namespaces</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Namespaces do not have a source location.
This is because there can be many namespaces.
We probably don&#8217;t want to store any javadocs for namespaces either.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_paths"><a class="anchor" href="#_paths"></a>Paths</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The AST visitor and metadata all use forward slashes to represent file
pathnames, even on Windows. This is so the generated reference documentation
does not vary based on the platform.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exceptions"><a class="anchor" href="#_exceptions"></a>Exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Errors thrown by the program should always have type <code>Exception</code>. Objects
of this type are capable of transporting an <code>Error</code> object. This is important
for the scripting to work; exceptions are used to propagate errors from
library code to scripts and back to the invoking code. For exceptional cases,
these thrown exceptions should be uncaught. The tool installs an uncaught exception
handler that prints a stack trace and exits the process immediately.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
